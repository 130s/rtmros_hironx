<launch>
  <arg name="CORBA_PORT" default="2809" />

  <!-- BEGIN RTM processes -->
  <!-- See https://github.com/start-jsk/rtmros_common/issues/416#issuecomment-46846623 -->
  <node name="start_omninames" pkg="rtmbuild" type="start_omninames.sh" args="$(arg CORBA_PORT)" />

  <include file="$(find hironx_ros_bridge)/launch/hironx_startup.launch" >
    <arg name="GUI" value="false" />
    <arg name="LAUNCH_HRPSYSPY" value="false" />
    <arg name="REALTIME" value="false" />
    <arg name="corbaport" value="$(arg CORBA_PORT)" />
  </include>
  <!-- END RTM processes -->

  <include file="$(find hironx_ros_bridge)/test/test-hironx-ros-bridge-common.launch">
    <arg name="corbaport" value="$(arg CORBA_PORT)" />
    <arg name="GUI" value="false" />
  </include>

  <!-- TODO Don't we want to run MoveIt!? -->

  <include file="$(find hironx_rpc_server)/launch/rpc_sim.launch"
           pass_all_args="true" />

  <test pkg="hironx_rpc_server" type="test_ros_rpc.py"
        test-name="ros_rpc" time-limit="240" retry="4"
        args="-ORBInitRef NameService=corbaloc:iiop:localhost:2809/NameService" />
</launch>
